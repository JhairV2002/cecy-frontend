<p-toolbar>
  <div class="p-toolbar-group-left">
    <h1>Asignaci√≥n de Instructores</h1>
    <button
      pButton
      pRipple
      type="button"
      label="Crear"
      class="p-button-success p-button-rounded"
      icon="pi pi-plus"
      (click)="redirect()"
    ></button>
    <button
      pButton
      pRipple
      type="button"
      label="Refrescar"
      class="p-button-rounded ml-2"
      icon="pi pi-sync"
      (click)="loadInstructors(paginator.current_page)"
    ></button>
    <button
      *ngIf="selectedInstructors?.length"
      pButton
      pRipple
      type="button"
      label="Eliminar seleccionados"
      class="p-button-danger p-button-rounded ml-2"
      icon="pi pi-trash"
      (click)="deleteInstructors()"
    ></button>
  </div>
  <div class="p-toolbar-group-right">
    <div class="p-inputgroup">
      <input
        pInputText
        id="search"
        [formControl]="search"
        (keypress)="filter($event)"
      />
      <button
        pButton
        pRipple
        type="button"
        icon="pi pi-search"
        (click)="filter($event)"
      ></button>
    </div>
  </div>
</p-toolbar>
<p-card>
  <p-paginator
    [rows]="paginator.per_page!"
    [totalRecords]="paginator.total!"
    (onPageChange)="paginate($event)"
  >
  </p-paginator>
  <p-table
    dataKey="id"
    styleClass="p-datatable-striped"
    [value]="(instructors$ | async)?.data"
    [columns]="cols"
    [loading]="(loaded$ | async)!"
    [(selection)]="selectedInstructors"
    [responsive]="true"
  >
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th style="width: 3rem">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>
        <th *ngFor="let col of columns" [pSortableColumn]="col.field">
          {{ col.header }}
          <p-sortIcon [field]="col.field"></p-sortIcon>
        </th>
        <th class="text-center">
          <button
            pButton
            pRipple
            type="button"
            class="p-button-rounded p-button-secondary"
            icon="pi pi-cog"
          ></button>
        </th>
      </tr>
    </ng-template>
    <ng-template
      pTemplate="body"
      let-rowData
      let-columns="columns"
      let-rowIndex="rowIndex"
    >
      <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex">
        <td>
          <p-tableCheckbox [value]="rowData"></p-tableCheckbox>
        </td>
        <td>
          {{ rowData["user"].username }}
        </td>
        <td>
          {{ rowData["user"].name }}
        </td>
        <td>
          {{ rowData["user"].lastname }}
        </td>
        <td>
          {{ rowData["user"].email }}
        </td>
        <td>
          {{ rowData["type"].name }}
        </td>
        <td>
          <form [formGroup]="formInstructor">
            <!-- <div class="field xl:col-6 lg:col-6 md:col-12 sm:col-12"> -->
            <label for="instructorType" appLabel label="Tipo de instructor:">
            </label>
            <p-dropdown
              [(ngModel)]="selectedType"
              id="instructorType"
              dataKey="id"
              formControlName="instructorType"
              [options]="instructorTypes"
              [filter]="true"
              filterBy="name"
              placeholder="Seleccione"
            >
              <ng-template pTemplate="selectedItem">
                <div *ngIf="instructorTypeField.value">
                  <div>{{ instructorTypeField.value?.name }}</div>
                </div>
              </ng-template>
              <ng-template let-item pTemplate="item">
                <div>
                  <div>{{ item.name }}</div>
                </div>
              </ng-template>
            </p-dropdown>
            <!-- </div> -->
          </form>
        </td>
        <td class="text-center">
          <p-button
            icon="pi pi-trash"
            (click)="deleteInstructor(rowData)"
          ></p-button>
          <p-button
            icon="pi pi-pencil"
            (click)="updateInstructor(rowData)"
          ></p-button>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="summary">
      {{ messageService.paginatorTotalRegisters(paginator) }}
    </ng-template>
    <ng-template pTemplate="emptymessage" let-columns>
      <tr>
        <td [attr.colspan]="columns.length">
          {{ messageService.paginatorNoRecordsFound }}
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>
